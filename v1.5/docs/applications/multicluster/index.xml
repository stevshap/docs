<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Verrazzano Enterprise Container Platform â€“ Multicluster</title>
    <link>/docs/applications/multicluster/</link>
    <description>Recent content in Multicluster on Verrazzano Enterprise Container Platform</description>
    <generator>Hugo -- gohugo.io</generator>
    
	  <atom:link href="/docs/applications/multicluster/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Docs: Multicluster Resources</title>
      <link>/docs/applications/multicluster/mcresources/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/docs/applications/multicluster/mcresources/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title>Docs: Use Rancher for Multicluster Verrazzano</title>
      <link>/docs/applications/multicluster/rancher-mc-integrate/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/docs/applications/multicluster/rancher-mc-integrate/</guid>
      <description>
        
        
        &lt;p&gt;Multicluster Verrazzano provides integration with Rancher that allows automatic synchronization of Rancher clusters with Verrazzano managed clusters, which simplifies your managed cluster registration process. By configuring cluster label selection, you can customize your Verrazzano installation to perform this automatic synchronization.&lt;/p&gt;
&lt;h2 id=&#34;step-1-enable-cluster-label-selection-in-verrazzano&#34;&gt;Step 1: Enable cluster label selection in Verrazzano&lt;/h2&gt;
&lt;p&gt;You can provide a label selector in the Verrazzano resource. The label selector is used to determine which clusters created in Rancher will be automatically registered by Verrazzano.&lt;/p&gt;
&lt;h3 id=&#34;verrazzano-configuration-for-cluster-label-selection&#34;&gt;Verrazzano configuration for cluster label selection&lt;/h3&gt;
&lt;p&gt;The following illustrates an admin cluster Verrazzano resource that has been configured to support cluster label selection.
&lt;style type=&#34;text/css&#34;&gt;
    code {
        margin: 0;
        padding: 0;
    }

    .copy-code-button {
        position: absolute;
        right: 0;
        top: -29px;
        font-size: 12px;
        line-height: 14px;
        width: 65px;
        color: white;
        background-color: #30638E;
        border: 1px solid #30638E;
        white-space: nowrap;
        padding: 6px 6px 7px 6px;
    }

    .copy-code-button:hover,
    .copy-code-button:focus{
        background-color: gray;
        opacity: 1;
    }

&lt;/style&gt;

&lt;div class=&#34;clipboard&#34;&gt;
    &lt;div class=&#34;highlight&#34;&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;apiVersion: install.verrazzano.io/v1beta1
kind: Verrazzano
metadata:
  name: admin
spec:
  profile: prod
  components:
    clusterOperator:
      overrides:
      - values:
          syncClusters:
            enabled: true
            clusterSelector:
              matchExpressions:
              - key: verrazzanomulticluster
                operator: In
                values: [supported]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
    function createCopyButton(highlightDiv) {
        const button = document.createElement(&#34;button&#34;);
        button.innerText = &#34;Copy&#34;;
        button.className = &#34;copy-code-button&#34;;
        button.addEventListener(&#34;click&#34;, () =&gt;
            copyCodeToClipboard(button, highlightDiv)
        );
        addCopyButton(button, highlightDiv);
    }

    function addCopyButton(button, highlightDiv) {
        highlightDiv.insertBefore(button, highlightDiv.firstChild);
        const wrapper = document.createElement(&#34;div&#34;);
        highlightDiv.parentNode.insertBefore(wrapper, highlightDiv);
        wrapper.appendChild(highlightDiv);
    }

    async function copyCodeToClipboard(button, highlightDiv) {
        let codeToCopy = highlightDiv.querySelector(&#34;:last-child &gt; code, pre&#34;).innerText;
        
        let codeBlock = codeToCopy.split(&#34;\n&#34;);
        let expectedLine = codeBlock.findIndex(line =&gt; line.toLowerCase().startsWith(&#34;# expected response&#34;) || line.toLowerCase().startsWith(&#34;# sample output&#34;));
        if (expectedLine !== -1) {
            codeBlock.splice(expectedLine);
        }
        codeToCopy = codeBlock.join(&#34;\n&#34;);
        
        codeToCopy = codeToCopy.replace(/^#(.*)$/gm, &#39;&#39;).trim();
        
        codeToCopy = codeToCopy.replace(/\$\s+/gm, &#39;&#39;).trim();
        codeToCopy = codeToCopy.replace(/\n{2,}/g,&#39;\n&#39;);
        console.log(codeToCopy);
        try {
            await navigator.clipboard.writeText(codeToCopy);
        } catch (err) {
            
            const textarea = document.createElement(&#39;textarea&#39;);
            textarea.value = codeToCopy;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand(&#39;copy&#39;);
            textarea.remove();
        }
        button.blur();
        button.innerText = &#34;Copied&#34;;
        setTimeout(function () {
            button.innerText = &#34;Copy&#34;;
        }, 2000);
    }


    document
        .querySelectorAll(&#34;.highlight&#34;)
        .forEach((highlightDiv) =&gt; createCopyButton(highlightDiv));
&lt;/script&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If &lt;code&gt;enabled&lt;/code&gt; is set to &lt;code&gt;false&lt;/code&gt; (the default), then no clusters created in Rancher will be automatically registered by Verrazzano.&lt;/li&gt;
&lt;li&gt;If &lt;code&gt;enabled&lt;/code&gt; is explicitly set to &lt;code&gt;true&lt;/code&gt;, then Verrazzano will automatically register clusters created in Rancher with labels that match the &lt;code&gt;clusterSelector&lt;/code&gt; field.
&lt;ul&gt;
&lt;li&gt;The &lt;code&gt;clusterSelector&lt;/code&gt; field is optional. If it is omitted, then all clusters created in Rancher will be automatically registered.&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;clusterSelector&lt;/code&gt; field implements a &lt;a href=&#34;https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.24
/#labelselector-v1-meta&#34;&gt;LabelSelector&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: If Argo CD is enabled in Verrazzano, then the label selector also is used by Verrazzano to select the Rancher clusters to automatically register with Argo CD. For more information about using Argo CD with Verrazzano, see &lt;a href=&#34;../../../docs/samples/argo-cd/&#34;&gt;Argo CD&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;step-2-register-managed-cluster-from-rancher-console&#34;&gt;Step 2: Register managed cluster from Rancher console&lt;/h2&gt;
&lt;p&gt;Verrazzano will manage all clusters whose labels match the &lt;a href=&#34;#cluster-label-selection&#34;&gt;cluster label selector&lt;/a&gt;, including Argo CD, if it is enabled on the admin cluster.&lt;/p&gt;
&lt;p&gt;To register a cluster using Rancher, complete the following steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Open the Rancher console on the admin cluster.
&lt;br&gt;You can find the Rancher console URL for your cluster by following the instructions for &lt;a href=&#34;../../../docs/access/&#34;&gt;Accessing Verrazzano&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Cluster Management&lt;/strong&gt;, and then click &lt;strong&gt;Import Existing Cluster&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Provide a name for your managed cluster. For example: &lt;em&gt;managed1&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;In your Verrazzano configuration, if you specified a cluster selection label, then under &lt;strong&gt;Labels &amp;amp; Annotations&lt;/strong&gt; provide a &lt;code&gt;label&lt;/code&gt; and &lt;code&gt;value&lt;/code&gt; for the Rancher cluster.
&lt;br&gt;For the Verrazzano synchronization to occur automatically, the &lt;code&gt;label&lt;/code&gt; and &lt;code&gt;value&lt;/code&gt; information should match the cluster selection &lt;code&gt;matchExpression&lt;/code&gt; in your Verrazzano configuration.&lt;/li&gt;
&lt;li&gt;After the import is complete, follow Rancher&amp;rsquo;s on-screen instructions to complete the registration by running the provided command against the managed cluster.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;After the Rancher cluster reaches the &lt;code&gt;Active&lt;/code&gt; state in the Rancher console, synchronization with Verrazzano will happen automatically and a VerrazzanoManagedCluster resource will be created in the &lt;code&gt;verrazzano-mc&lt;/code&gt; namespace.&lt;/p&gt;
&lt;p&gt;Run the following command to view the details and status of Verrazzano&amp;rsquo;s multicluster initialization operations:
&lt;style type=&#34;text/css&#34;&gt;
    code {
        margin: 0;
        padding: 0;
    }

    .copy-code-button {
        position: absolute;
        right: 0;
        top: -29px;
        font-size: 12px;
        line-height: 14px;
        width: 65px;
        color: white;
        background-color: #30638E;
        border: 1px solid #30638E;
        white-space: nowrap;
        padding: 6px 6px 7px 6px;
    }

    .copy-code-button:hover,
    .copy-code-button:focus{
        background-color: gray;
        opacity: 1;
    }

&lt;/style&gt;

&lt;div class=&#34;clipboard&#34;&gt;
    &lt;div class=&#34;highlight&#34;&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ kubectl get vmc -n verrazzano-mc &amp;lt;Rancher_cluster_name&amp;gt; -o yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
    function createCopyButton(highlightDiv) {
        const button = document.createElement(&#34;button&#34;);
        button.innerText = &#34;Copy&#34;;
        button.className = &#34;copy-code-button&#34;;
        button.addEventListener(&#34;click&#34;, () =&gt;
            copyCodeToClipboard(button, highlightDiv)
        );
        addCopyButton(button, highlightDiv);
    }

    function addCopyButton(button, highlightDiv) {
        highlightDiv.insertBefore(button, highlightDiv.firstChild);
        const wrapper = document.createElement(&#34;div&#34;);
        highlightDiv.parentNode.insertBefore(wrapper, highlightDiv);
        wrapper.appendChild(highlightDiv);
    }

    async function copyCodeToClipboard(button, highlightDiv) {
        let codeToCopy = highlightDiv.querySelector(&#34;:last-child &gt; code, pre&#34;).innerText;
        
        let codeBlock = codeToCopy.split(&#34;\n&#34;);
        let expectedLine = codeBlock.findIndex(line =&gt; line.toLowerCase().startsWith(&#34;# expected response&#34;) || line.toLowerCase().startsWith(&#34;# sample output&#34;));
        if (expectedLine !== -1) {
            codeBlock.splice(expectedLine);
        }
        codeToCopy = codeBlock.join(&#34;\n&#34;);
        
        codeToCopy = codeToCopy.replace(/^#(.*)$/gm, &#39;&#39;).trim();
        
        codeToCopy = codeToCopy.replace(/\$\s+/gm, &#39;&#39;).trim();
        codeToCopy = codeToCopy.replace(/\n{2,}/g,&#39;\n&#39;);
        console.log(codeToCopy);
        try {
            await navigator.clipboard.writeText(codeToCopy);
        } catch (err) {
            
            const textarea = document.createElement(&#39;textarea&#39;);
            textarea.value = codeToCopy;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand(&#39;copy&#39;);
            textarea.remove();
        }
        button.blur();
        button.innerText = &#34;Copied&#34;;
        setTimeout(function () {
            button.innerText = &#34;Copy&#34;;
        }, 2000);
    }


    document
        .querySelectorAll(&#34;.highlight&#34;)
        .forEach((highlightDiv) =&gt; createCopyButton(highlightDiv));
&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;For more information, see &lt;a href=&#34;https://ranchermanager.docs.rancher.com/v2.6/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/register-existing-clusters&#34;&gt;Registering Existing Clusters&lt;/a&gt; in the Rancher documentation.&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
